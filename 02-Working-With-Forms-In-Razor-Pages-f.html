<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Working with Forms in Razor Pages</title>
<link href="assets/css/bootstrap.css" rel="stylesheet">
<!-- Custom styles for this template -->
<link href="assets/css/starter-template.css" rel="stylesheet">
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=css&amp;skin=sunburst"></script>
<style type="text/css">
html {
	font-size: 90.0%;
}

h2 {
	margin-top: 60px;
}

h4, h3 {
	padding-top: 40px!;		
}

p {
	font-size: 1.2em;
}
h4 {
	font-size: 1.4em;
}

img, pre.prettyprint {
	margin-top: 1.5em;
	margin-bottom: 1.5em;
}
h1, h2, h3, h4, h5, h6 {
    color:#007bff;

}
blockquote {
    border-left: 4px solid #999;
    padding-left: 1rem;
    page-break-inside: avoid;
}
:target:before {
  content: "";
  display: block;
  height: 80px; /* adjust this value to your needs */
  margin: -80px 0 0; /* this should be a negative value of the height above */
}
</style>
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
</head>
<body>
<header>
    <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#">LinkedIn - ASP.NET Core Razor Pages</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse"
                aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarCollapse">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#">Home</a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link" href="#">Working with Forms in Razor Pages <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">About</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>
<div class="container">
    <div class="starter-template">

<h1 id="working-with-forms-in-razor-pages">Working with Forms in Razor Pages</h1>
<p>Code: <code>Sandbox\Razor\MovieApp</code></p>
<p><strong>Note:</strong> in these code examples we are not going to use <code>scaffolding</code> to build our pages. All the HTML and code will be added manually.</p>
<h2 id="one-way-data-binding">One way data binding</h2>
<p>The following file has hard coded data. We are going to change this with one way data binding.</p>
<h3 id="moviescshtml">Movies.cshtml</h3>
<pre class="prettyprint"><code><div>    @page
    @model MoviesApp.Pages.MoviesModel
    @{
        ViewData[<span class="hljs-string">"Title"</span>] = <span class="hljs-string">"List of all movies"</span>;
    }

    &lt;h3&gt;@ViewData[<span class="hljs-string">"Title"</span>]&lt;/h3&gt;
    &lt;hr /&gt;

    &lt;table <span class="hljs-keyword">class</span>=<span class="hljs-string">"table table-striped"</span>&gt;
        &lt;thead&gt;
            &lt;tr&gt;
                &lt;th scope=<span class="hljs-string">"col"</span>&gt;<span class="hljs-meta">#&lt;/th&gt;</span>
                &lt;th scope=<span class="hljs-string">"col"</span>&gt;Title&lt;/th&gt;
                &lt;th scope=<span class="hljs-string">"col"</span>&gt;Rate&lt;/th&gt;
                &lt;th scope=<span class="hljs-string">"col"</span>&gt;Actions&lt;/th&gt;
            &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;
            &lt;tr&gt;
                &lt;th scope=<span class="hljs-string">"row"</span>&gt;<span class="hljs-number">1</span>&lt;/th&gt;
                &lt;td&gt;Mark <span class="hljs-keyword">is</span> example movie title&lt;/td&gt;
                &lt;td&gt;<span class="hljs-number">9</span>/<span class="hljs-number">10</span>&lt;/td&gt;
                &lt;td&gt;&lt;a href=<span class="hljs-string">"/Movie/6"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"btn btn-secondary"</span>&gt;Show details&lt;/a&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                ...
            &lt;/tr&gt;

        &lt;/tbody&gt;
    &lt;/table&gt;

    &lt;div style=<span class="hljs-string">"position: fixed; bottom: 70px;right:25px;"</span>&gt;
        &lt;a href=<span class="hljs-string">"/AddMovie"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"btn btn-success"</span>&gt;Add <span class="hljs-keyword">new</span>&lt;/a&gt;
    &lt;/div&gt;
</div></code></pre>
<p>Create the folders <code>Data/Models</code>.</p>
<p>Create a class named <code>Movie</code>.</p>
<h3 id="moviecs">Movie.cs</h3>
<pre class="prettyprint"><code><div>    <span class="hljs-keyword">namespace</span> <span class="hljs-title">MoviesApp.Data.Models</span>
    {
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Movie</span>
        {
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

            <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span>? Title { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

            <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> Rate { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

            <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span>? Description { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        }
    }
</div></code></pre>
<p>In the <code>Movies.cshtml.cs</code> model we will add the data binding.</p>
<p>We create a list of movies.</p>
<pre class="prettyprint"><code><div>    <span class="hljs-keyword">public</span> List&lt;Movie&gt; Movies { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div></code></pre>
<p>This will give you an error so we have to add the following <code>using</code> statement.</p>
<pre class="prettyprint"><code><div>    <span class="hljs-keyword">using</span> MoviesApp.Data.Models;
</div></code></pre>
<p><strong>Note:</strong> you have to make the <code>List&lt;Movie&gt;</code> <code>public</code> so that it can be see in the view.</p>
<p>When you want to send data from the <code>Model</code> to the <code>View</code> you need to use the <code>OnGet()</code> method.</p>
<p>When you want to get data from the <code>View</code> to the <code>Model</code> you have to use the <code>OnPost()</code> method.</p>
<p>In <code>OnGet()</code> create a list of Movies.</p>
<h3 id="moviescshtmlcs">Movies.cshtml.cs</h3>
<pre class="prettyprint"><code><div>    <span class="hljs-keyword">using</span> Microsoft.AspNetCore.Mvc;
    <span class="hljs-keyword">using</span> Microsoft.AspNetCore.Mvc.RazorPages;
    <span class="hljs-keyword">using</span> MoviesApp.Data.Models;

    <span class="hljs-keyword">namespace</span> <span class="hljs-title">MoviesApp.Pages</span>
    {
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MoviesModel</span> : <span class="hljs-title">PageModel</span>
        {
            <span class="hljs-keyword">public</span> List&lt;Movie&gt; Movies { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnGet</span>(<span class="hljs-params"></span>)</span>
            {
                Movies = <span class="hljs-keyword">new</span> List&lt;Movie&gt;()
                {
                    <span class="hljs-keyword">new</span> Movie()
                    {
                        Id = <span class="hljs-number">1</span>,
                        Title = <span class="hljs-string">"First movie"</span>,
                        Rate = <span class="hljs-number">8</span>,
                        Description = <span class="hljs-string">"This is the first movie."</span>
                    },
                    <span class="hljs-keyword">new</span> Movie()
                    {
                        Id = <span class="hljs-number">2</span>,
                        Title = <span class="hljs-string">"Second movie"</span>,
                        Rate = <span class="hljs-number">8</span>,
                        Description = <span class="hljs-string">"This is the second movie."</span>
                    },
                    <span class="hljs-keyword">new</span> Movie()
                    {
                        Id = <span class="hljs-number">3</span>,
                        Title = <span class="hljs-string">"Third movie"</span>,
                        Rate = <span class="hljs-number">8</span>,
                        Description = <span class="hljs-string">"This is the third movie."</span>
                    },
                    <span class="hljs-keyword">new</span> Movie()
                    {
                        Id = <span class="hljs-number">4</span>,
                        Title = <span class="hljs-string">"Fourth movie"</span>,
                        Rate = <span class="hljs-number">8</span>,
                        Description = <span class="hljs-string">"This is the fourth movie."</span>
                    }
                };
            }
        }
    }
</div></code></pre>
<p>Now, we need to take out the hard coded data in <code>Movies.cshtml</code> and replace it with the one way model binding from the Model.</p>
<h3 id="moviescshtml">Movies.cshtml</h3>
<pre class="prettyprint"><code><div>    @page
    @model MoviesApp.Pages.MoviesModel

    @{
        ViewData[<span class="hljs-string">"Title"</span>] = <span class="hljs-string">"List of all movies"</span>;
    }

    &lt;h3&gt;@ViewData[<span class="hljs-string">"Title"</span>]&lt;/h3&gt;
    &lt;hr /&gt;

    &lt;table <span class="hljs-keyword">class</span>=<span class="hljs-string">"table table-striped"</span>&gt;
        &lt;thead&gt;
            &lt;tr&gt;
                &lt;th scope=<span class="hljs-string">"col"</span>&gt;<span class="hljs-meta">#&lt;/th&gt;</span>
                &lt;th scope=<span class="hljs-string">"col"</span>&gt;Title&lt;/th&gt;
                &lt;th scope=<span class="hljs-string">"col"</span>&gt;Rate&lt;/th&gt;
                &lt;th scope=<span class="hljs-string">"col"</span>&gt;Actions&lt;/th&gt;
            &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;

            @<span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> movie <span class="hljs-keyword">in</span> Model.Movies)
            {
                &lt;tr&gt;
                    &lt;th scope=<span class="hljs-string">"row"</span>&gt;@movie.Id&lt;/th&gt;
                    &lt;td&gt;@movie.Title&lt;/td&gt;
                    &lt;td&gt;@movie.Rate/<span class="hljs-number">10</span>&lt;/td&gt;
                    &lt;td&gt;@movie.Description&lt;/td&gt;
                    &lt;td&gt;&lt;a href=<span class="hljs-string">"/Movie/@movie.Id"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"btn btn-secondary"</span>&gt;Show details&lt;/a&gt;&lt;/td&gt;
                &lt;/tr&gt;
            }

        &lt;/tbody&gt;
    &lt;/table&gt;

    &lt;div style=<span class="hljs-string">"position: fixed; bottom: 70px;right:25px;"</span>&gt;
        &lt;a href=<span class="hljs-string">"/AddMovie"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"btn btn-success"</span>&gt;Add <span class="hljs-keyword">new</span>&lt;/a&gt;
    &lt;/div&gt;
</div></code></pre>
<p>When we run the program we get the following result.</p>
<p><img src="assets/images/movies-list-view.jpg" alt="List of movies" title="List of movies"></p>
<h2 id="two-way-data-binding">Two way data binding</h2>
<p>Forms use two way data binding. We will build the Add Movie page so we can add data to a form and get data from a form.</p>
<p>The form will use the <code>OnPost()</code> method to data from the Razor Form (<code>View</code>).</p>
<p>In our <code>PageModel</code> we are going to use properties to gather our data.</p>
<h3 id="addmoviecshtmlcs">AddMovie.cshtml.cs</h3>
<pre class="prettyprint"><code><div>    <span class="hljs-keyword">using</span> Microsoft.AspNetCore.Mvc;
    <span class="hljs-keyword">using</span> Microsoft.AspNetCore.Mvc.RazorPages;

    <span class="hljs-keyword">namespace</span> <span class="hljs-title">MoviesApp.Pages</span>
    {
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AddMovieModel</span> : <span class="hljs-title">PageModel</span>
        {
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span>? Title { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

            <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> Rate { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

            <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span>? Description { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnGet</span>(<span class="hljs-params"></span>)</span>
            {
                Title = <span class="hljs-string">"My new movie"</span>;
            }
        }
    }
</div></code></pre>
<p>In our code we can initialise data with the <code>OnGet()</code> method. In our case we could create a new <code>Title</code>.</p>
<p>Now we will add the model to our AddMovie.cshtml view.</p>
<h3 id="addmoviecshtml">AddMovie.cshtml</h3>
<pre class="prettyprint"><code><div>    @page
    @model MoviesApp.Pages.AddMovieModel
    @{
        ViewData[<span class="hljs-string">"Title"</span>] = <span class="hljs-string">"Add new movie"</span>;
    }

    &lt;h3&gt;@ViewData[<span class="hljs-string">"Title"</span>]&lt;/h3&gt;
    &lt;hr /&gt;

    &lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">"row"</span>&gt;
        &lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">"col-md-6 offset-3"</span>&gt;
            &lt;form method=<span class="hljs-string">"post"</span>&gt;
                &lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">"mb-3"</span>&gt;
                    &lt;label <span class="hljs-keyword">for</span>=<span class="hljs-string">"title"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"form-label"</span>&gt;Title&lt;/label&gt;
                    &lt;input name=<span class="hljs-string">"Title"</span> type=<span class="hljs-string">"text"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"form-control"</span> id=<span class="hljs-string">"title"</span> placeholder=<span class="hljs-string">"Movie title"</span>&gt;
                &lt;/div&gt;
                &lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">"mb-3"</span>&gt;
                    &lt;label <span class="hljs-keyword">for</span>=<span class="hljs-string">"rate"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"form-label"</span>&gt;Rate&lt;/label&gt;
                    &lt;input name=<span class="hljs-string">"Rate"</span> type=<span class="hljs-string">"number"</span> min=<span class="hljs-string">"1"</span> max=<span class="hljs-string">"10"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"form-control"</span> id=<span class="hljs-string">"rate"</span> placeholder=<span class="hljs-string">"9"</span>&gt;
                &lt;/div&gt;
                &lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">"mb-3"</span>&gt;
                    &lt;label <span class="hljs-keyword">for</span>=<span class="hljs-string">"description"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"form-label"</span>&gt;Description&lt;/label&gt;
                    &lt;textarea name=<span class="hljs-string">"Description"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"form-control"</span> id=<span class="hljs-string">"description"</span> rows=<span class="hljs-string">"3"</span>&gt;&lt;/textarea&gt;
                &lt;/div&gt;

                &lt;button type=<span class="hljs-string">"submit"</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"btn btn-success"</span>&gt;Add Movie&lt;/button&gt;
            &lt;/form&gt;
        &lt;/div&gt;
    &lt;/div&gt;
</div></code></pre>
<p>We have added <code>name</code> values to each field. These relate to our properties in the model.</p>
<p><strong>Note:</strong> we have to change the form to accept a <code>post</code> method.</p>
<pre class="prettyprint"><code><div>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"post"</span>&gt;</span>
</div></code></pre>
<p>Go back to the <code>PageModel</code> and we need to add an <code>OnPost()</code> method to receive a request.</p>
<pre class="prettyprint"><code><div>    <span class="hljs-function"><span class="hljs-keyword">public</span> IActionResult <span class="hljs-title">OnPost</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">string</span> <span class="hljs-keyword">value</span> = <span class="hljs-string">$"<span class="hljs-subst">{Title}</span> - <span class="hljs-subst">{Rate}</span>/10 - <span class="hljs-subst">{Description}</span>"</span>;

        <span class="hljs-keyword">return</span> Page();
    }
</div></code></pre>
<p>Add a break point on the <code>return Page();</code> statement and debug the code.</p>
<p>When we hit the return page statement we hover over the <code>value</code> variable and we see that there is no data present.</p>
<p>The reason is that when we use this method we can only send data to the view. If we want these properties to be <strong>bi-directional</strong> we have to use <strong>binding</strong>.</p>
<p>To do this we have to use a decorator named <code>BindProperty</code> on each of our fields.</p>
<h3 id="addmoviecshtmlcs">AddMovie.cshtml.cs</h3>
<pre class="prettyprint"><code><div>    <span class="hljs-keyword">using</span> Microsoft.AspNetCore.Mvc;
    <span class="hljs-keyword">using</span> Microsoft.AspNetCore.Mvc.RazorPages;

    <span class="hljs-keyword">namespace</span> <span class="hljs-title">MoviesApp.Pages</span>
    {
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AddMovieModel</span> : <span class="hljs-title">PageModel</span>
        {
            [<span class="hljs-meta">BindProperty</span>]
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span>? Title { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

            [<span class="hljs-meta">BindProperty</span>]
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> Rate { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

            [<span class="hljs-meta">BindProperty</span>]
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span>? Description { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnGet</span>(<span class="hljs-params"></span>)</span>
            {
                Title = <span class="hljs-string">"My new movie"</span>;
            }

            <span class="hljs-function"><span class="hljs-keyword">public</span> IActionResult <span class="hljs-title">OnPost</span>(<span class="hljs-params"></span>)</span>
            {
                <span class="hljs-keyword">string</span> <span class="hljs-keyword">value</span> = <span class="hljs-string">$"<span class="hljs-subst">{Title}</span> - <span class="hljs-subst">{Rate}</span>/10 - <span class="hljs-subst">{Description}</span>"</span>;

                <span class="hljs-keyword">return</span> Page();
            }
        }
    }
</div></code></pre>
<p>Debug the code again and this time when you over over the variable, <code>value</code> you will see.</p>
<p><img src="assets/images/locals.jpg" alt="Local variables" title="Local variables"></p>
<p>So if you want variable to persist from the <code>View</code> to the <code>PageModel</code> you will have to use binding.</p>
<h2 id="event-binding">Event binding</h2>
<p>Add a page handler to the AddMovie Razor page. This allows us to bind on user events.</p>
<pre class="prettyprint"><code><div>    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>@ViewData["Title"]<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">asp-page-handler</span>=<span class="hljs-string">"MyOnClick"</span>&gt;</span> Click me<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"row"</span>&gt;</span>
</div></code></pre>
<p>On the PageModel add a new method.</p>
<pre class="prettyprint"><code><div>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnGetMyOnClick</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">string</span> stopHere = <span class="hljs-keyword">string</span>.Empty;
    }
</div></code></pre>
<p>Add a breakpoint on the <code>stopHere</code> statement and start debugging. Once you hover over the <code>Click me</code> link you will see the link below.</p>
<p><img src="assets/images/page-handler.jpg" alt="Page handler" title="Page handler"></p>
<p>When you click the link you can see that you are transported to the page handler method, <code>OnGetMyOnClick()</code> so everything is working as anticipated.</p>
<h2 id="model-binding-in-aspnet-razor-pages">Model Binding in ASP.Net Razor pages</h2>
<p>The way we used binding in the previous example isn't sustainable. Suppose we had 30 properties then it would be hard to manage. This is where model binding is a better option.</p>
<p>Add a <code>Movie</code> model to the <code>PageModel</code>.</p>
<pre class="prettyprint"><code><div>    <span class="hljs-keyword">using</span> Microsoft.AspNetCore.Mvc;
    <span class="hljs-keyword">using</span> Microsoft.AspNetCore.Mvc.RazorPages;
    <span class="hljs-keyword">using</span> MoviesApp.Data.Models;

    <span class="hljs-keyword">namespace</span> <span class="hljs-title">MoviesApp.Pages</span>
    {
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AddMovieModel</span> : <span class="hljs-title">PageModel</span>
        {
            <span class="hljs-keyword">public</span> Movie? Movie { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnGet</span>(<span class="hljs-params"></span>)</span>
            {
            }

            <span class="hljs-function"><span class="hljs-keyword">public</span> IActionResult <span class="hljs-title">OnPost</span>(<span class="hljs-params"></span>)</span>
            {
                <span class="hljs-keyword">string</span> <span class="hljs-keyword">value</span> = <span class="hljs-string">$"<span class="hljs-subst">{Title}</span> - <span class="hljs-subst">{Rate}</span>/10 - <span class="hljs-subst">{Description}</span>"</span>;

                <span class="hljs-keyword">return</span> Page();
            }
        }
    }
</div></code></pre>
<p><strong>Note:</strong> you have to add the following <code>using</code> reference.</p>
<pre class="prettyprint"><code><div>    <span class="hljs-keyword">using</span> MoviesApp.Data.Models;
</div></code></pre>
<p>This allows you to use the <code>Movie</code> model.</p>
<p>On the <code>AddModel.cshtml</code> Razor page change the fields to reflect the Model.</p>
<pre class="prettyprint"><code><div>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"post"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-3"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"title"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-label"</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Movie.Title"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"title"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Movie title"</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-3"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"rate"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-label"</span>&gt;</span>Rate<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Movie.Rate"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span> <span class="hljs-attr">min</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">max</span>=<span class="hljs-string">"10"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"rate"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"9"</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-3"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"description"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-label"</span>&gt;</span>Description<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Movie.Description"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"description"</span> <span class="hljs-attr">rows</span>=<span class="hljs-string">"3"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-success"</span>&gt;</span>Add Movie<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
</div></code></pre>
<p>Now change the PageModel <code>OnPost()</code> method.</p>
<pre class="prettyprint"><code><div>    <span class="hljs-function"><span class="hljs-keyword">public</span> IActionResult <span class="hljs-title">OnPost</span>(<span class="hljs-params"></span>)</span>
    {
        <span class="hljs-keyword">string</span> <span class="hljs-keyword">value</span> = <span class="hljs-string">$"<span class="hljs-subst">{Movie.Title}</span> - <span class="hljs-subst">{Movie.Rate}</span>/10 - <span class="hljs-subst">{Movie.Description}</span>"</span>;
        <span class="hljs-keyword">return</span> Page();
    }
</div></code></pre>
<p>And add a breakpoint on the value statement and debug.</p>
<p>When you hover over <code>value</code> you get a null value. All of the Movie values get a null exception because once again you need to bind to the <code>Movie</code> model.</p>
<p>Add.</p>
<pre class="prettyprint"><code><div>    [<span class="hljs-meta">BindProperty</span>]
    <span class="hljs-keyword">public</span> Movie? Movie { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div></code></pre>
<p>And debug again.</p>
<p><img src="assets/images/local-values-model.jpg" alt="Binding to a model" title="Binding to a model"></p>
<h2 id="form-validation">Form validation</h2>
<p>When working with forms it is important that you validate the form data before you store it in a database.</p>
<p>In our example you will learn how to validate on the back end and show any errors on the front end.</p>
<p>You need to add a validation message on every form field.</p>
<p>In <code>AddMovie.cshtml</code>.</p>
<pre class="prettyprint"><code><div>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"post"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-3"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"title"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-label"</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Movie.Title"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"title"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Movie title"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">asp-validation-for</span>=<span class="hljs-string">"@Model.Movie.Title"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-danger"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-3"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"rate"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-label"</span>&gt;</span>Rate<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Movie.Rate"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span> <span class="hljs-attr">min</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">max</span>=<span class="hljs-string">"10"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"rate"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"9"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">asp-validation-for</span>=<span class="hljs-string">"@Model.Movie.Rate"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-danger"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-3"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"description"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-label"</span>&gt;</span>Description<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Movie.Description"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"description"</span> <span class="hljs-attr">rows</span>=<span class="hljs-string">"3"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">asp-validation-for</span>=<span class="hljs-string">"@Model.Movie.Description"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-danger"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-success"</span>&gt;</span>Add Movie<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
</div></code></pre>
<p>We will change the <code>Movie</code> model.</p>
<h3 id="datamodelsmoviecs">Data/Models/Movie.cs</h3>
<pre class="prettyprint"><code><div>    <span class="hljs-keyword">using</span> System.ComponentModel.DataAnnotations;

    <span class="hljs-keyword">namespace</span> <span class="hljs-title">MoviesApp.Data.Models</span>
    {
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Movie</span>
        {
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

            [<span class="hljs-meta">Required, StringLength(50)</span>]
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span>? Title { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

            [<span class="hljs-meta">Required</span>]
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> Rate { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

            [<span class="hljs-meta">Required, StringLength(50)</span>]
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span>? Description { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        }
    }
</div></code></pre>
<p>In the <code>PageModel</code>.</p>
<pre class="prettyprint"><code><div>    <span class="hljs-function"><span class="hljs-keyword">public</span> IActionResult <span class="hljs-title">OnPost</span>(<span class="hljs-params"></span>)</span>
    {
         <span class="hljs-keyword">string</span> <span class="hljs-keyword">value</span> = <span class="hljs-string">$"<span class="hljs-subst">{Movie.Title}</span> - <span class="hljs-subst">{Movie.Rate}</span>/10 - <span class="hljs-subst">{Movie.Description}</span>"</span>;

         <span class="hljs-keyword">if</span> (!ModelState.IsValid)
         {
             <span class="hljs-keyword">return</span> Page();
         }

         <span class="hljs-keyword">return</span> Redirect(<span class="hljs-string">"Movies"</span>);
    }
</div></code></pre>
<p>Once again, add a breakpoint on the <code>if()</code> statement and debug.</p>
<p>If we don't add any values into the fields and click the <code>Add Movie</code> button the validation fails and we return the current page with the following errors.</p>
<p><img src="assets/images/validation-errors.jpg" alt="Validation errors" title="Validation errors"></p>
<p>Add some valid input into each of the fields and this time once you pass validation you will be returned to the <code>Movies</code> page.</p>
<p>We could also use <code>TempData</code> to pass the data once validated to the <code>Movies</code> page. At present we are not adding the new Movie to the Movies list so for a temporary solution we could use the <code>[TempData]</code> annotation.</p>
<h3 id="addmoviecsharpcs">AddMovie.csharp.cs</h3>
<pre class="prettyprint"><code><div>    <span class="hljs-keyword">using</span> Microsoft.AspNetCore.Mvc;
    <span class="hljs-keyword">using</span> Microsoft.AspNetCore.Mvc.RazorPages;
    <span class="hljs-keyword">using</span> MoviesApp.Data.Models;

    <span class="hljs-keyword">namespace</span> <span class="hljs-title">MoviesApp.Pages</span>
    {
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AddMovieModel</span> : <span class="hljs-title">PageModel</span>
        {
            [<span class="hljs-meta">BindProperty</span>]
            <span class="hljs-keyword">public</span> Movie? Movie { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

            [<span class="hljs-meta">TempData</span>]
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Message { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnGet</span>(<span class="hljs-params"></span>)</span>
            {
            }

            <span class="hljs-function"><span class="hljs-keyword">public</span> IActionResult <span class="hljs-title">OnPost</span>(<span class="hljs-params"></span>)</span>
            {
                <span class="hljs-keyword">string</span> <span class="hljs-keyword">value</span> = <span class="hljs-string">$"<span class="hljs-subst">{Movie.Title}</span> - <span class="hljs-subst">{Movie.Rate}</span>/10 - <span class="hljs-subst">{Movie.Description}</span>"</span>;

                <span class="hljs-keyword">if</span> (!ModelState.IsValid)
                {
                    <span class="hljs-keyword">return</span> Page();
                }

                Message = <span class="hljs-keyword">value</span>;

                <span class="hljs-keyword">return</span> Redirect(<span class="hljs-string">"Movies"</span>);
            }
        }
    }
</div></code></pre>
<p>This creates a <code>Message</code> property and we store the results of <code>value</code> if the <code>ModelState</code> is valid.</p>
<p>Add a <code>Message</code> field on the Movies.cshtml Razor page.</p>
<pre class="prettyprint"><code><div>    &lt;h3&gt;@ViewData[<span class="hljs-string">"Title"</span>]&lt;/h3&gt;
    &lt;hr /&gt;

    &lt;h5&gt;Message: @Model.Message&lt;/h5&gt;

    &lt;table <span class="hljs-keyword">class</span>=<span class="hljs-string">"table table-striped"</span>&gt;
</div></code></pre>
<p>In the <code>Movies</code> PageModel add the <code>Message</code> property.</p>
<pre class="prettyprint"><code><div>    <span class="hljs-keyword">public</span> List&lt;Movie&gt;? Movies { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

    [<span class="hljs-meta">TempData</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> Message { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
</div></code></pre>
<p>Once you have added valid data in the AddMovie page you will see the following message appear on the <code>Movies</code> Razor page.</p>
<p><img src="assets/images/temp-data-message.jpg" alt="Using TempData" title="Using TempData"></p>
<h3 id="conclusion">Conclusion</h3>
<p>We have seen that there are three ways of Data Binding.</p>
<ol>
<li>One way binding</li>
<li>Two way binding</li>
<li>Event binding</li>
</ol>

</div><!-- starter-template -->
</div><!-- /.container -->


<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"/>
<script>hljs.initHighlightingOnLoad();</script>

<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
</body>
</html>